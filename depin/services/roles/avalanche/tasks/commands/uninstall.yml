---
- name: Disable systemd service
  ansible.builtin.include_tasks: commands/stop.yml

- name: Uninstall metrics
  vars:
    depin_cmd: uninstall
  ansible.builtin.include_tasks:
    file: tasks/metrics.yml

- name: Delete content & directory
  become: true
  ansible.builtin.file:
    state: absent
    path: "{{ uninstall_file }}"
  loop:
    - /etc/systemd/system/avalanchego.service
    - /usr/local/bin/avalanchego
    - /opt/avalanche/{{ avalanche_version }}
  loop_control:
    loop_var: uninstall_file
