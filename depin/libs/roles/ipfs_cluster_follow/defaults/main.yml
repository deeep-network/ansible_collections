---
ipfs_cluster_follow_version: v1.1.1
ipfs_cluster_follow_download_url:
  "https://dist.ipfs.tech/ipfs-cluster-follow/{{ ipfs_cluster_follow_version }}\
  /ipfs-cluster-follow_{{ ipfs_cluster_follow_version }}_{{ ansible_system | lower }}-{{ system_architecture }}.tar.gz"

ipfs_cluster_follow_fd_max_files: 1000000

ipfs_cluster_follow_partial_config: {}
ipfs_cluster_follow_cluster:
  peername: "{{ ipfs_cluster_follow_node_id }}"
  leave_on_shutdown: false
  listen_multiaddress:
    - /ip4/0.0.0.0/tcp/9096
    - /ip4/0.0.0.0/udp/9096/quic
  announce_multiaddress: []
  no_announce_multiaddress: []
  enable_relay_hop: true
  connection_manager:
    high_water: 400
    low_water: 100
    grace_period: 2m
  resource_manager:
    enabled: true
    memory_limit_bytes: 0
    file_descriptors_limit: 0
  dial_peer_timeout: 3s
  state_sync_interval: 1h
  # pin_recover_interval: "{{ ipfs_cluster_follow_cluster['state_sync_interval'] }}"
  replication_factor_min: -1
  replication_factor_max: -1
  monitor_ping_interval: 15s
  peer_watch_interval: 5s
  mdns_interval: 10s
  pin_only_on_trusted_peers: false
  pin_only_on_untrusted_peers: false
  disable_repinning: true
  peer_addresses: []

ipfs_cluster_follow_consensus_crdt:
  trusted_peers:
    - "*"
  batching:
    max_batch_size: 50
    max_batch_age: 1m
    max_queue_size: 5000
  repair_interval: 1h
  rebroadcast_interval: 15s

ipfs_cluster_follow_ipfs_connector_ipfshttp:
  node_multiaddress: /ip4/127.0.0.1/tcp/5001
  connect_swarms_delay: 30s
  ipfs_request_timeout: 5m
  pin_timeout: 20s
  unpin_timeout: 3h
  repogc_timeout: 24h
  informer_trigger_interval: 0

ipfs_cluster_follow_pin_tracker_stateless:
    concurrent_pins: 10
    priority_pin_max_age: 24h
    priority_pin_max_retries: 3
    max_pin_queue_size: 200000000

ipfs_cluster_follow_allocator_type: default
ipfs_cluster_follow_allocator_balanced_allocate_by:
  - tag:{{ ipfs_cluster_follow_allocator_type }}
  - pinqueue
  - freespace

ipfs_cluster_follow_informer:
  disk:
    metric_ttl: 5m
    metric_type: freespace
  pinqueue:  
    metric_ttl: 5m
    weight_bucket_size: 100000
  tags:
    metric_ttl: 5m
    tags:
      group: "{{ ipfs_cluster_follow_allocator_type }}"

ipfs_cluster_follow_observations_metrics:
    enable_stats: true
    prometheus_endpoint: /ip4/0.0.0.0/tcp/8888
    reporting_interval: 15s

ipfs_cluster_follow_datastore_pebble:
  pebble_options:
      max_open_files: 1000000
